<UserControl
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ImageView" 
			 x:Class="ImageView.ImageViews" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="800">
	<UserControl.Resources>
		<Storyboard x:Key="Sb_ShowTools">
			<ThicknessAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.Margin)" Storyboard.TargetName="border">
				<EasingThicknessKeyFrame KeyTime="0:0:0.5" Value="0"/>
			</ThicknessAnimationUsingKeyFrames>
		</Storyboard>
		<Storyboard x:Key="Sb_HideTools">
			<ThicknessAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.Margin)" Storyboard.TargetName="border">
				<EasingThicknessKeyFrame KeyTime="0:0:0.5" Value="0,0,0,-46"/>
			</ThicknessAnimationUsingKeyFrames>
		</Storyboard>
		<Style x:Key="ImageToolBtn" TargetType="{x:Type Button}">
			<Setter Property="FocusVisualStyle" Value="{x:Null}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Padding" Value="1"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Border x:Name="Chrome" BorderBrush="Transparent" Background="Transparent" SnapsToDevicePixels="true">
							<ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="true">
								<Setter Property="Foreground" Value="#FF288ADD"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="true">
								<Setter Property="Foreground" Value="White"/>
							</Trigger>
							<Trigger Property="IsEnabled" Value="false">
								<Setter Property="Foreground" Value="#ADADAD"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
        <TransformGroup x:Key="TfGroup">
            <ScaleTransform/>
            <SkewTransform/>
            <RotateTransform Angle="0"/>
            <TranslateTransform/>
        </TransformGroup>
        <Storyboard x:Key="sb_Tips">
        	<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="gridTips">
        		<DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
        		<DiscreteObjectKeyFrame KeyTime="0:0:0.8" Value="{x:Static Visibility.Visible}"/>
        		<DiscreteObjectKeyFrame KeyTime="0:0:1.3" Value="{x:Static Visibility.Collapsed}"/>
        	</ObjectAnimationUsingKeyFrames>
        	<DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="gridTips">
        		<EasingDoubleKeyFrame KeyTime="0" Value="0"/>
        		<EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
        		<EasingDoubleKeyFrame KeyTime="0:0:1" Value="1"/>
        		<EasingDoubleKeyFrame KeyTime="0:0:1.3" Value="0"/>
        	</DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>

	<Grid ClipToBounds="True">
		<ScrollViewer 
			x:Name="svImg"
			VerticalScrollBarVisibility="Hidden"
			HorizontalScrollBarVisibility="Hidden" >
			<Grid x:Name="rootGrid" Background="#FFDAD5D5">
				<ContentControl x:Name="control" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0">
                    <Image x:Name="imgBig" 
                           LayoutTransform="{StaticResource TfGroup}"  
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center" 
                           RenderTransformOrigin="0.5,0.5">
					</Image>
				</ContentControl>

			</Grid>

		</ScrollViewer>
		<Grid x:Name="gridMouse" Background="#19000000"/>
        
		<Grid Margin="0" Width="200" Height="200" HorizontalAlignment="Right" VerticalAlignment="Bottom" Background="#4C000000">
			<ContentControl x:Name="controlmask" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0">
                    <Image x:Name="imgless"  
                           LayoutTransform="{StaticResource TfGroup}" 
                           Margin="0" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
			</ContentControl>
			<local:MaskCanvas x:Name="mask" 
                              Width="{Binding ActualWidth, ElementName=controlmask}"
                              Height="{Binding ActualHeight, ElementName=controlmask}" Margin="0"/>
		</Grid>
		<Border x:Name="border" BorderThickness="0" Margin="0,0,0,-46" VerticalAlignment="Bottom" HorizontalAlignment="Center" CornerRadius="5,5,0,0" Background="#66000000">
			<StackPanel HorizontalAlignment="Center" VerticalAlignment="Bottom" Height="46" Orientation="Horizontal" Margin="0">
				<Button x:Name="btnActualsize" ToolTip="实际大小" Content="1:1" FontSize="20" Margin="10,0,5,0" Style="{DynamicResource ImageToolBtn}" Cursor="Hand"/>
				<Button x:Name="btnEnlarge" ToolTip="图片放大" Margin="5,0" Style="{DynamicResource ImageToolBtn}" Cursor="Hand">
					<Path Data="M5.673863,3.2889999 L7.0767274,3.2889999 7.0767274,5.72111 9.533,5.72111 9.533,7.1742001 7.0767274,7.1742001 7.0767274,9.6050006 5.673863,9.6050006 5.673863,7.1742001 3.217,7.1742001 3.217,5.72111 5.673863,5.72111 z M6.3070703,1.4097974 C5.4283705,1.4201729 4.5419398,1.6635488 3.7439018,2.1621917 1.4222865,3.6127289 0.71198823,6.6831284 2.1637352,9.0061189 3.6142719,11.327799 6.6833558,12.036217 9.0056105,10.58568 11.328476,9.1350423 12.037475,6.0659228 10.586278,3.7430426 9.6339302,2.2193809 7.9845882,1.3899893 6.3070703,1.4097974 z M6.4434238,0.0004323783 C8.542512,0.024875602 10.5856,1.0849572 11.780875,2.9968732 13.435871,5.6466618 12.898772,9.0321189 10.673577,11.066093 L14.180247,16.334451 C14.332647,16.566156 14.423984,16.872989 14.192785,17.026595 L12.872123,17.539151 C12.639724,17.691455 12.543241,17.309263 12.390841,17.077455 L9.2574797,12.023116 C6.3434468,13.511456 2.735364,12.577831 0.96906754,9.7522584 -0.89609847,6.766441 0.012133633,2.8340891 2.9977234,0.96947071 4.070725,0.29891717 5.2658859,-0.01327962 6.4434238,0.0004323783 z" Stretch="Uniform" Fill="{Binding Foreground, ElementName=btnEnlarge}" Margin="3,0" RenderTransformOrigin="0.5,0.5" Width="15" Height="18"/>
				</Button>
				<Button x:Name="btnNarrow" ToolTip="图片缩小" Margin="5,0" Style="{DynamicResource ImageToolBtn}" Cursor="Hand">
							<Path Data="M3.218,5.7210003 L9.5319996,5.7210003 9.5319996,7.1739999 3.218,7.1739999 z M6.3070727,1.4097974 C5.4283724,1.4201729 4.5419379,1.6635488 3.7438889,2.1621917 1.4223012,3.6127289 0.71200206,6.6831284 2.1637604,9.0061189 3.6142586,11.327799 6.6833453,12.036217 9.0056019,10.58568 11.32857,9.1350423 12.03747,6.0659228 10.586271,3.7430426 9.6339226,2.2193809 7.9845915,1.3899893 6.3070727,1.4097974 z M6.443439,0.0004323783 C8.5425291,0.024875602 10.585629,1.0849572 11.78097,2.9968732 13.435867,5.6466618 12.898768,9.0321189 10.673571,11.066093 L14.269413,16.487474 C14.421811,16.719179 14.346851,16.910811 14.115652,17.064417 L13.000247,17.461768 C12.767848,17.614072 12.70392,17.603825 12.55152,17.372017 L9.2574721,12.023116 C6.3441758,13.511456 2.7353499,12.577831 0.96908184,9.7522584 -0.89611605,6.766441 0.0121469,2.8340891 2.9977396,0.96947071 4.0707422,0.29891717 5.2659006,-0.01327962 6.443439,0.0004323783 z" Stretch="Uniform" Fill="{Binding Foreground, ElementName=btnNarrow}" Margin="3,0" RenderTransformOrigin="0.5,0.5" Width="15" Height="18"/>
				</Button>
				<Button x:Name="btnRotate" Margin="5,0,10,0" ToolTip="向右旋转" Style="{DynamicResource ImageToolBtn}" Cursor="Hand">
					<Path HorizontalAlignment="Center" Height="20" Margin="2,0" Stretch="Fill" Stroke="{Binding Foreground, ElementName=btnRotate}" VerticalAlignment="Center" Width="15" Fill="{Binding Foreground, ElementName=btnRotate}">
						<Path.Data>
							<PathGeometry>
								<PathFigure IsFilled="False" StartPoint="16.2190003713877,19.6035522853233">
									<BezierSegment IsSmoothJoin="True" Point3="5.10457704168024,21.0735324544862" Point2="8.71361877552593,23.166809691682" Point1="13.2722301368137,22.5638931790653"/>
									<BezierSegment IsSmoothJoin="True" Point3="0.814570247855613,10.6688420983592" Point2="-0.264022957327099,14.7127427250565" Point1="1.49553588552836,18.9802552172904"/>
									<BezierSegment Point3="9.70832246424933,3.81300002336502" Point2="5.54096000659884,3.81300002336502" Point1="1.89316345303832,6.62494193594543"/>
								</PathFigure>
								<PathFigure IsClosed="True" StartPoint="10.2492547230302,0.500000004000907">
									<PolyLineSegment Points="10.218,6.438 13.937,3.562779"/>
								</PathFigure>
							</PathGeometry>
						</Path.Data>
					</Path>
				</Button>
			</StackPanel>
		</Border>
		<Grid x:Name="gridTips" IsHitTestVisible="False" HorizontalAlignment="Center" MinWidth="75" VerticalAlignment="Center" Visibility="Collapsed" Opacity="0">
			<Rectangle Fill="#B2000000" RadiusX="5" RadiusY="5"/>
            <TextBlock x:Name="txtZoom" HorizontalAlignment="Center" FontSize="18" Text="5%" VerticalAlignment="Center" Margin="10,5" Foreground="White"/>
		</Grid>
		
	</Grid>
</UserControl>
